/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@mediapipe/pose"),require("@tensorflow/tfjs-core")):"function"==typeof define&&define.amd?define(["exports","@mediapipe/pose","@tensorflow/tfjs-core"],t):t((e=e||self).poseDetection={},e.globalThis,e.tf)}(this,(function(e,t,n){"use strict";var o=function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function i(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{u(o.next(e))}catch(e){r(e)}}function s(e){try{u(o.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((o=o.apply(e,t||[])).next())}))}function r(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}var a=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"],s={left:[1,2,3,7,9,11,13,15,17,19,21,23,25,27,29,31],right:[4,5,6,8,10,12,14,16,18,20,22,24,26,28,30,32],middle:[0]},u=[[0,1],[0,4],[1,2],[2,3],[3,7],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[11,23],[12,14],[14,16],[12,24],[13,15],[15,17],[16,18],[16,20],[15,17],[15,19],[15,21],[16,22],[17,19],[18,20],[23,25],[23,24],[24,26],[25,27],[26,28],[27,29],[28,30],[27,31],[28,32],[29,31],[30,32]];function l(e){return e instanceof SVGAnimatedLength?e.baseVal.value:e}function c(e){return i(this,void 0,void 0,(function(){var t,o;return r(this,(function(i){switch(i.label){case 0:return t=document.createElement("canvas"),e instanceof n.Tensor?[4,n.browser.toPixels(e,t)]:[3,2];case 1:return i.sent(),[3,3];case 2:t.width=l(e.width),t.height=l(e.height),o=t.getContext("2d"),e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0),i.label=3;case 3:return[2,t]}}))}))}function f(e){return i(this,void 0,void 0,(function(){var t,o,i,a,s,u;return r(this,(function(r){switch(r.label){case 0:return e instanceof n.Tensor?(t=e.shape.slice(0,2),o=t[0],i=t[1],a=ImageData.bind,[4,n.browser.toPixels(e)]):[3,2];case 1:return[2,new(a.apply(ImageData,[void 0,r.sent(),i,o]))];case 2:return s=document.createElement("canvas"),u=s.getContext("2d"),s.width=l(e.width),s.height=l(e.height),u.drawImage(e,0,0),[2,u.getImageData(0,0,s.width,s.height)]}}))}))}function h(e){return i(this,void 0,void 0,(function(){var t,o;return r(this,(function(i){switch(i.label){case 0:return e instanceof SVGImageElement||e instanceof OffscreenCanvas?[4,c(e)]:[3,2];case 1:return o=i.sent(),[3,3];case 2:o=e,i.label=3;case 3:return t=o,[2,n.browser.fromPixels(t,4)]}}))}))}var p={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"};var d=function(){function e(e){this.mask=e}return e.prototype.toCanvasImageSource=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){return[2,this.mask]}))}))},e.prototype.toImageData=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){return[2,f(this.mask)]}))}))},e.prototype.toTensor=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){return[2,h(this.mask)]}))}))},e.prototype.getUnderlyingType=function(){return"canvasimagesource"},e}();function m(e){return function(e){if(e<0||e>=256)throw new Error("Mask value must be in range [0, 255] but got ".concat(e));if(!Number.isInteger(e))throw new Error("Mask value must be an integer but got ".concat(e))}(e),"person"}var g,y,b=function(){function e(e){var n,o=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new t.Pose({locateFile:function(t,n){if(e.solutionPath){var o=e.solutionPath.replace(/\/+$/,"");return"".concat(o,"/").concat(t)}return"".concat(n,"/").concat(t)}}),e.modelType){case"lite":n=0;break;case"heavy":n=2;break;case"full":default:n=1}this.poseSolution.setOptions({modelComplexity:n,smoothLandmarks:e.enableSmoothing,enableSegmentation:e.enableSegmentation,smoothSegmentation:e.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults((function(e){if(o.height=e.image.height,o.width=e.image.width,null==e.poseLandmarks)o.poses=[];else{var t=o.translateOutput(e.poseLandmarks,e.poseWorldLandmarks);e.segmentationMask&&(t.segmentation={maskValueToLabel:m,mask:new d(e.segmentationMask)}),o.poses=[t]}}))}return e.prototype.translateOutput=function(e,t){var n=this,o={keypoints:e.map((function(e,t){return{x:e.x*n.width,y:e.y*n.height,z:e.z,score:e.visibility,name:a[t]}}))};return null!=t&&(o.keypoints3D=t.map((function(e,t){return{x:e.x,y:e.y,z:e.z,score:e.visibility,name:a[t]}}))),o},e.prototype.estimatePoses=function(e,t,o){return i(this,void 0,void 0,(function(){var i,a;return r(this,(function(r){switch(r.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),e instanceof n.Tensor?(a=ImageData.bind,[4,n.browser.toPixels(e)]):[3,2];case 1:return i=new(a.apply(ImageData,[void 0,r.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:i=e,r.label=3;case 3:return e=i,[4,this.poseSolution.send({image:e},o)];case 4:return r.sent(),[2,this.poses]}}))}))},e.prototype.dispose=function(){this.poseSolution.close()},e.prototype.reset=function(){this.poseSolution.reset()},e.prototype.initialize=function(){return this.poseSolution.initialize()},e}();function v(e){return i(this,void 0,void 0,(function(){var t,n;return r(this,(function(i){switch(i.label){case 0:return t=function(e){if(null==e)return o({},p);var t=o({},e);return t.runtime="mediapipe",null==t.enableSegmentation&&(t.enableSegmentation=p.enableSegmentation),null==t.enableSmoothing&&(t.enableSmoothing=p.enableSmoothing),null==t.smoothSegmentation&&(t.smoothSegmentation=p.smoothSegmentation),null==t.modelType&&(t.modelType=p.modelType),t}(e),[4,(n=new b(t)).initialize()];case 1:return i.sent(),[2,n]}}))}))}(g=e.SupportedModels||(e.SupportedModels={})).MoveNet="MoveNet",g.BlazePose="BlazePose",g.PoseNet="PoseNet",(y=e.TrackerType||(e.TrackerType={})).Keypoint="keypoint",y.BoundingBox="boundingBox";var w=Object.freeze({__proto__:null,getKeypointIndexBySide:function(e){return s},getAdjacentPairs:function(e){return u},getKeypointIndexByName:function(e){return a.reduce((function(e,t,n){return e[t]=n,e}),{})}});var _={keypointsToNormalizedKeypoints:function(e,t){return e.map((function(e){var n=o(o({},e),{x:e.x/t.width,y:e.y/t.height});return null!=e.z&&(e.z=e.z/t.width),n}))}};e.calculators=_,e.createDetector=function(e,t){return i(this,void 0,void 0,(function(){var e,n;return r(this,(function(o){if(null!=(e=t)){if("mediapipe"===e.runtime)return[2,v(t)];n=e.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(n))}))}))},e.util=w,Object.defineProperty(e,"__esModule",{value:!0})}));
